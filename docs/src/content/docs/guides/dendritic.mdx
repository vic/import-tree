---
title: Dendritic Pattern
description: How import-tree enables the Dendritic pattern for Nix configurations.
---

import { Aside } from '@astrojs/starlight/components';

## What is the Dendritic Pattern?

The [Dendritic pattern](https://github.com/mightyiam/dendritic) is a convention where **each file is a self-contained Nix module**. Rather than large monolithic files, your configuration becomes a directory tree where each concern lives in its own file.

```
modules/
  networking.nix       # network config
  openssh.nix          # SSH server
  desktop/
    sway.nix           # window manager
    waybar.nix         # status bar
    notifications.nix  # notification daemon
  users/
    alice.nix           # user account
```

Each file is a standard Nix module:

```nix
# modules/openssh.nix
{ ... }: {
  services.openssh.enable = true;
  services.openssh.settings.PasswordAuthentication = false;
}
```

## Why Dendritic?

- **Locality** — each concern in its own file, easy to find and modify
- **Composability** — add or remove features by adding or removing files
- **No boilerplate** — `import-tree` handles the wiring
- **Git-friendly** — file additions don't cause merge conflicts in import lists
- **Discoverable** — directory structure documents the system

## Using with flake-parts

With flake-parts, each file is a flake-parts module:

```nix
# flake.nix
{
  inputs.import-tree.url = "github:vic/import-tree";
  inputs.flake-parts.url = "github:hercules-ci/flake-parts";

  outputs = inputs: inputs.flake-parts.lib.mkFlake { inherit inputs; }
    (inputs.import-tree ./modules);
}
```

```nix
# modules/dev-shell.nix
{ inputs, ... }: {
  perSystem = { pkgs, ... }: {
    devShells.default = pkgs.mkShell {
      packages = [ pkgs.nil pkgs.nixfmt-rfc-style ];
    };
  };
}
```

## The `/_` Convention

<Aside type="tip">
Use underscore-prefixed directories for helper code that shouldn't be auto-imported.
</Aside>

Files under `/_` prefixed paths are ignored by default. This gives you a place for shared utilities:

```
modules/
  feature.nix
  _lib/
    helpers.nix    # not auto-imported
```

```nix
# modules/feature.nix
let helpers = import ./_lib/helpers.nix;
in { ... }: { /* use helpers */ }
```

## Further Reading

- [Dendritic Design](https://github.com/mightyiam/dendritic) — the pattern specification
- [@mightyiam's post](https://discourse.nixos.org/t/pattern-each-file-is-a-flake-parts-module/61271) — introducing the pattern
- [@drupol's blog](https://not-a-number.io/2025/refactoring-my-infrastructure-as-code-configurations/) — real-world adoption
- [Dendrix](https://dendrix.oeiuwq.com/) — index of dendritic aspects
